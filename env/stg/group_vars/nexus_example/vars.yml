---
stand_type: "stg"
cert_env: "stg"
nexus_port: 8081
nexus_port_for_docker: 8181

jdk_version: java-1.8.0-openjdk
jdk_version_ubuntu: openjdk-8-jdk

nginx:
  upstreams:
    - { name: "nexus8081", server: 127.0.0.1, domain: "{{internal_domain}}", port: "{{nexus_port}}", fail_timeout: 0, conf: "nginx-localhost-upstream.conf.j2"}
    - { name: "nexus8181", server: 127.0.0.1, domain: "{{internal_domain}}", port: "{{nexus_port_for_docker}}", fail_timeout: 0, conf: "nginx-localhost-upstream.conf.j2"}
  vhosts:
    - { servername: "nexus.{{nginx_default_domain}} repo.{{nginx_default_domain}}", domain: "{{nginx_default_domain}}",
        http_port: 80, https_ports: 443, config_file: "vhost-general.conf.j2",
        certname: "{{nginx_cert_name}}",privkey: "{{nginx_privkey_name}}",
        upstream_protocol: http, upstream_name: nexus8081, ssl_rewrite: "yes" , cert_type: "wild"}
    - { servername: "repo-docker.{{nginx_default_domain}}", domain: "{{nginx_default_domain}}",
        http_port: 80, https_ports: 443, config_file: "vhost-general.conf.j2",
        certname: "{{nginx_cert_name}}",privkey: "{{nginx_privkey_name}}",
        upstream_protocol: http, upstream_name: nexus8181, ssl_rewrite: "yes" , cert_type: "wild" }
  include:
    - "/etc/nginx/include/tls1_2-tls1_3.conf"
  size_upload_files:
    - { client_max_body_size: "1024M"}
  config: "nginx.conf.nexus"

zabbix:
  apply_tag:
    - linux
    - nexus


iptables:
  rules:
#### system rules
    - { name: "admin_net", protocol: "tcp", port: "22", source: "{{admin_net}}"}
## mon access
    - { name: "node_exporter", protocol: "tcp", port: "9100", source: "{{mon_net}}"}
    - { name: "zabbix", protocol: "tcp", port: "10050", source: "{{mon_net}}"}
###  application access
    - { name: "nginx", protocol: tcp, port: "80", source: "{{internal_net_access}}"}
    - { name: "nginx", protocol: tcp, port: "443", source: "{{internal_net_access}}"}



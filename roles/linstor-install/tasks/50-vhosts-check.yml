---
- name: Validate linstor configuration inside the container
  shell: "docker exec -t linstor linstor -t"
  register: linstor_docker_config_status
  failed_when: linstor_docker_config_status.rc != 0
  changed_when: false

- name: Display validation result
  debug:
    msg: >
      linstor configuration validation result: 
      {{ 'SUCCESS' if linstor_docker_config_status.rc == 0 else 'FAILED' }}

- name: Reload linstor configuration if validation succeeded
  shell: "docker exec -t linstor linstor -s reload"
  when: linstor_docker_config_status.rc == 0

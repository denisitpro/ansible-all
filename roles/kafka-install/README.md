# Настройка Kafka с KRaft

Для кластерной Kafka **крайне желательно** задать переменную `kafka_kraft_cluster_id`.  
Ее можно сгенерировать с помощью команды:
```sh
uuidgen
```

## Определение логики приоритетности

При настройке Kafka для подключения к KRaft используется следующая логика приоритетности:

1. Если переменная `kafka_cluster_servers` определена и содержит хотя бы один элемент, используется список серверов из этой переменной.
2. Если переменная `kafka_broker_id_group_calculate` присутствует, используются серверы из этой группы.
3. В противном случае используется standalone (`0@127.0.0.1:9093`).


## Пример данных для конфигурации

### Определение группы серверов kafka
```yaml
kafka_cluster_group: kafka_group_example
```
Пример группы
```ini
[kafka_group_example]
kafka-01.example.com
kafka-02.example.com
kafka-03.example.com
```

### Переменная `kafka_cluster_servers`

```yaml
kafka_cluster_servers:
  - hostname: kafka-01.example.com
    id: 2222  # Параметр `id` обязателен
    port: 9093  # Параметр `port` не обязателен, по умолчанию используется `9093`
  - hostname: kafka-02.example.com
    id: 2  # Параметр `id` обязателен
  - hostname: kafka-03.example.com
    id: 3  # Параметр `id` обязателен
```

## Итоговая настройка Kafka

В результате применения этой логики Kafka будет подключаться к другим серверам согласно приоритетам:
- Если `kafka_cluster_servers` определена, то используется список серверов из этой переменной.
- Если `kafka_broker_id_group_calculate` определена, то используются серверы из группы.
- Если ничего не задано, используется `0@127.0.0.1:9093`.

Такой подход позволяет гибко настраивать подключение Kafka в зависимости от инфраструктурных требований.

## {{ ansible_managed }} ##
PidFile=/var/run/zabbix/zabbix_agentd.pid
LogFile=/var/log/zabbix/zabbix_agentd.log

{% if dc_location == 'fsn' and  ansible_distribution_major_version == '7'%}
ListenIP={{ ansible_eth1.ipv4.address if ( dc_location == 'fsn' ) else ansible_default_ipv4.address }}
{% endif %}
{% if dc_location == 'fsn' and  ansible_distribution_major_version == '8'%}
ListenIP={{ ansible_facts[second_interface_name].ipv4.address  if ( dc_location == 'fsn' ) else ansible_default_ipv4.address }}
{% endif %}


LogFileSize=0
Server={{ '127.0.0.1' if ( ansible_hostname == 'zbx.example.com' ) else zserver }}
ServerActive={{ '127.0.0.1' if ( ansible_hostname == 'zbx.example.com' ) else zserveractive }}
HostnameItem=system.hostname
HostMetadata={% for zbx in  zabbix.apply_tag %}{{zbx}} {% endfor %}

Timeout=30
Include=/etc/zabbix/zabbix_agentd.d/*.conf

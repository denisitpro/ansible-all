
{% for item in k8s_prom_remote_write %}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ item.remote_write.secret_name }}
  namespace: monitoring
type: Opaque
data:
{% if item.remote_write.secret_type == 'mtls' %}
  client.crt: {{ (item.remote_write.tls_config.cert_file | default('')) | b64encode }}
  client.key: {{ (item.remote_write.tls_config.key_file | default('')) | b64encode }}
  cacert: {{ (item.remote_write.tls_config.ca_file | default('')) | b64encode }}
{% elif item.remote_write.secret_type == 'http-basic' %}
  username: {{ (item.remote_write.basic_auth.username | default('')) | b64encode }}
  password: {{ (item.remote_write.basic_auth.password | default('')) | b64encode }}
{% else %}
  # Default fallback for unknown secret types
  client.crt: {{ (item.remote_write.tls_config.cert_file | default('')) | b64encode }}
  client.key: {{ (item.remote_write.tls_config.key_file | default('')) | b64encode }}
  cacert: {{ (item.remote_write.tls_config.ca_file | default('')) | b64encode }}
{% endif %}
{% endfor %}
---
- name: Cilium hubble-ui - Copy hubble-ui manifests
  ansible.builtin.template:
    src: "{{ item }}.j2"
    dest: /tmp/{{ item }}
    mode: "0600"
  with_items:
    - hubble-ui.yml

- name: Cilium hubble-ui - Patch svc hubble-ui
  ansible.builtin.command: kubectl --kubeconfig {{ k8s_config_path }} patch svc hubble-ui -n cilium --type merge --patch-file /tmp/hubble-ui.yml
  with_items:
    - hubble-ui.yml

- name: Cilium hubble-ui - remove files
  ansible.builtin.file:
    path: /tmp/{{ item }}
    state: absent
  with_items:
    - hubble-ui.yml
